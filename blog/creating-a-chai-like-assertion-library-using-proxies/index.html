<!DOCTYPE html><html lang="en" data-astro-cid-gjtny2mx> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Creating a Chai like assertion library using proxies | Pablo Berganza</title><link rel="alternate" hreflang="es" href="https://pablo.berganza.dev/es/blog/creating-a-chai-like-assertion-library-using-proxies"><link href="/apple-icon-57x57.png" rel="apple-touch-icon" sizes="57x57"><link href="/apple-icon-60x60.png" rel="apple-touch-icon" sizes="60x60"><link href="/apple-icon-72x72.png" rel="apple-touch-icon" sizes="72x72"><link href="/apple-icon-76x76.png" rel="apple-touch-icon" sizes="76x76"><link href="/apple-icon-114x114.png" rel="apple-touch-icon" sizes="114x114"><link href="/apple-icon-120x120.png" rel="apple-touch-icon" sizes="120x120"><link href="/apple-icon-144x144.png" rel="apple-touch-icon" sizes="144x144"><link href="/apple-icon-152x152.png" rel="apple-touch-icon" sizes="152x152"><link href="/apple-icon-180x180.png" rel="apple-touch-icon" sizes="180x180"><link href="/android-icon-192x192.png" rel="icon" sizes="192x192" type="image/png"><link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"><link href="/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png"><link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"><link rel="icon" type="image/png" href="/favicon.ico"><link href="/manifest.json" rel="manifest"><meta content="#E34495" name="msapplication-TileColor"><meta content="ms-icon-144x144.png" name="msapplication-TileImage"><meta content="#E34495" name="theme-color"><script type="module" src="https://unpkg.com/yt-vid@0.0.5/dist/yt-vid/yt-vid.esm.js"></script><script src="/scripts/focus-visible.js" defer></script>
    <script type="application/ld+json">
     {
      "@context": "https://schema.org/",
      "@type": "BlogPosting",
      "headline": "Creating a Chai like assertion library using proxies",
      "alternativeHeadline": "Showcasing how I made a fun side-project to be used with uvu",
      "image": "https://pablo.berganza.dev/assets/blog-pics/2022-02-19.png",
      "dateCreated": "2022-02-19",
      "datePublished": "2022-02-19",
      "isFamilyFriendly": "true",
      "publisher": {
        "@type": "Person",
        "name": "Pablo Berganza",
        "url": "https://pablo.berganza.dev/",
        "email": "pablo@berganza.dev",
        "jobTitle": "Software Engineer"
      },
      "author": {
        "@type": "Person",
        "name": "Pablo Berganza",
        "url": "https://pablo.berganza.dev/",
        "email": "pablo@berganza.dev",
        "jobTitle": "Software Engineer"
      }
     }
    </script>
<meta name="author" content="Pablo Berganza"><meta name="description" content="Showcasing how I made a fun side-project to be used with uvu"><meta name="title" content="Creating a Chai like assertion library using proxies"><meta itemprop="name" content="Creating a Chai like assertion library using proxies"><meta itemprop="description" content="Showcasing how I made a fun side-project to be used with uvu"><meta name="twitter:image" content="https://pablo.berganza.dev/assets/blog-pics/2022-02-19.png"><meta property="og:image" content="https://pablo.berganza.dev/assets/blog-pics/2022-02-19.png"><meta itemprop="image" content="https://pablo.berganza.dev/assets/blog-pics/2022-02-19.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Creating a Chai like assertion library using proxies"><meta name="twitter:description" content="Showcasing how I made a fun side-project to be used with uvu"><meta name="twitter:site" content="Pablo_ABC"><meta name="twitter:creator" content="Pablo_ABC"><meta property="og:title" content="Creating a Chai like assertion library using proxies"><meta property="og:url" content="https://pablo.berganza.dev/blog/creating-a-chai-like-assertion-library-using-proxies"><meta property="og:site_name" content="Pablo Berganza"><meta property="og:description" content="Showcasing how I made a fun side-project to be used with uvu"><meta property="og:locale" content="en"><meta property="fb:admins" content="1441268341"><meta property="fb:app_id" content="2097322913669232"><meta property="og:type" content="article"><meta property="article:author" content="Pablo Berganza"><meta property="article:published_time" content="2022-02-19"><meta name="twitter:data1" value="8 min"><meta name="twitter:data2" value="Pablo Berganza"><meta name="twitter:label1" value="Reading time"><meta name="twitter:label2" value="Author"><meta name="color-scheme" content="light dark"><style>.lang-link[data-astro-cid-c5lam3sp]{position:absolute;top:1rem;right:10vw;z-index:1}
</style>
<link rel="stylesheet" href="/_astro/_slug_.fwJCB4vp.css" />
<style>a[data-astro-cid-ivbvd6ux].home-page-link{display:inline-block;font-family:Roboto Slab,serif;font-size:2rem;font-weight:700;padding:.5rem;margin-left:10vw;color:var(--color-heading);text-decoration:none}svg[data-astro-cid-skev4gdg]{height:1.125rem}svg[data-astro-cid-ne6vazln]{height:1.125rem}
</style>
<link rel="stylesheet" href="/_astro/index.1c9VM4IX.css" />
<style>.visuallyhidden.svelte-57m7wt{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}div.svelte-57m7wt{border-top:2px solid var(--color-primary-1);padding-top:20px}div.svelte-57m7wt .commento-submit-button{background:var(--color-secondary-2-3)!important}div.svelte-57m7wt .commento-submit-button{transition:color .1s}div.svelte-57m7wt .commento-submit-button:hover{background:var(--color-secondary-2-1)!important}div.svelte-57m7wt .commento-email-button{color:var(--color-secondary-2-3)!important;height:50px!important}div.svelte-57m7wt .commento-login-link{color:var(--color-secondary-2-3)!important}div.svelte-57m7wt .commento-login-box{background:#fff7fb!important}div.svelte-57m7wt *{font-family:Overpass,Helvetica Neue,Verdana,Helvetica,Arial,sans-serif!important;color:var(--base-font-color)!important}div.svelte-57m7wt .commento-button,div.svelte-57m7wt .commento-avatar{color:#fff2f8!important}div.svelte-57m7wt .commento-sort-policy-buttons-container .commento-sort-policy-buttons .commento-sort-policy-button-selected{color:var(--color-secondary-2-3)!important}div.svelte-57m7wt .commento-option-button{background:#a18795!important}div.svelte-57m7wt .commento-upvoted,div.svelte-57m7wt .commento-downvoted{background:var(--color-secondary-2-3)!important}div.svelte-57m7wt .commento-option-remove{background:#e03131!important}
</style><script type="module" src="/_astro/hoisted.ARHv5G3l.js"></script></head> <body data-astro-cid-gjtny2mx> <main data-astro-cid-gjtny2mx> <a class="home-page-link" aria-label="Home page" href="/" data-astro-cid-ivbvd6ux>PB</a>  <a class="lang-link" href="/es/blog/creating-a-chai-like-assertion-library-using-proxies" lang="es" data-astro-cid-c5lam3sp> ¿Hablas español? </a>  <article data-astro-cid-gjtny2mx> <header data-astro-cid-gjtny2mx> <h1 class="title" data-astro-cid-gjtny2mx>Creating a Chai like assertion library using proxies</h1> <p data-astro-cid-gjtny2mx>Showcasing how I made a fun side-project to be used with uvu</p> </header> <img alt="" class="banner" src="/assets/blog-pics/2022-02-19.png" width="1136" height="852" data-astro-cid-gjtny2mx> <div class="stats" data-astro-cid-gjtny2mx> <div class="ttr" data-astro-cid-gjtny2mx> <span data-astro-cid-gjtny2mx> <svg role="img" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-astro-cid-skev4gdg> <title>Reading time:</title> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" data-astro-cid-skev4gdg></path> </svg>  </span> <time datetime="8m" data-astro-cid-gjtny2mx> 8  minutes </time> </div> <div class="created" data-astro-cid-gjtny2mx> <span data-astro-cid-gjtny2mx> <svg role="img" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-astro-cid-ne6vazln> <title>Creation date:</title> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-astro-cid-ne6vazln></path> </svg>  </span> <time class="created-date" datetime="2022-02-19" data-astro-cid-gjtny2mx>February 19, 2022 </time> </div> </div> <div class="tags" data-astro-cid-gjtny2mx> Tags: <ul data-astro-cid-gjtny2mx> <li data-astro-cid-gjtny2mx> <a href="/blog/tags/javascript" data-astro-cid-gjtny2mx> javascript </a> </li><li data-astro-cid-gjtny2mx> <a href="/blog/tags/testing" data-astro-cid-gjtny2mx> testing </a> </li><li data-astro-cid-gjtny2mx> <a href="/blog/tags/uvu" data-astro-cid-gjtny2mx> uvu </a> </li><li data-astro-cid-gjtny2mx> <a href="/blog/tags/webdev" data-astro-cid-gjtny2mx> webdev </a> </li> </ul> </div> <div class="tags" data-astro-cid-gjtny2mx> Also available on: <ul data-astro-cid-gjtny2mx> <li data-astro-cid-gjtny2mx> <a href="https://dev.to/pabloabc/creating-a-chai-like-assertion-library-using-proxies-1ol7" data-astro-cid-gjtny2mx>dev.to</a> </li> <li data-astro-cid-gjtny2mx> <a href="https://hn.berganza.dev/creating-a-chai-like-assertion-library-using-proxies" data-astro-cid-gjtny2mx>hashnode</a> </li> </ul> </div> <section class="content" data-astro-cid-gjtny2mx> <details data-astro-cid-obewoz47> <summary data-astro-cid-obewoz47> <svg aria-hidden="true" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg> <span data-astro-cid-obewoz47>Table of contents</span> </summary> <ol id="toc" data-astro-cid-obewoz47> <li data-astro-cid-obewoz47> <a href="#the-expect-function" data-astro-cid-obewoz47>The “expect” function</a>  </li><li data-astro-cid-obewoz47> <a href="#adding-meaning-to-our-properties" data-astro-cid-obewoz47>Adding meaning to our properties</a>  </li><li data-astro-cid-obewoz47> <a href="#defining-properties" data-astro-cid-obewoz47>Defining properties</a>  </li><li data-astro-cid-obewoz47> <a href="#negating-assertions" data-astro-cid-obewoz47>Negating assertions</a>  </li><li data-astro-cid-obewoz47> <a href="#do-not-throw-normal-errors" data-astro-cid-obewoz47>Do not throw normal Errors</a>  </li><li data-astro-cid-obewoz47> <a href="#conclusion" data-astro-cid-obewoz47>Conclusion</a>  </li> </ol> </details>  <p>For the past few weeks I’ve taken the (arguably pointless) work of migrating <a href="https://felte.dev">Felte</a> from using Jest to <a href="https://github.com/lukeed/uvu">uvu</a>. This is a really tedious work by itself, but one of details that would have made this work even more tedious is that Jest prefers assertions to the style of <code>expect(…).toBe*</code> while uvu gives you freedom to choose any assertion library, although there’s an official <code>uvu/assert</code> module that comes with assertions to the style of <code>assert.is(value, expected)</code>.</p>
<p>While this is fine and I could have perfectly moved all my tests to use said assertion style, I like the descriptive way Jest tests look like. As a quick way to maintain certain similarity I reached for <a href="https://chaijs.com">ChaiJS</a>, an assertion library that is mainly used with <a href="https://mochajs.org">mocha</a>. Chai offers <code>expect</code> like assertions that can arguably be more descriptive than Jest’s. Instead of writing <code>expect(…).toBe(true)</code>, you’d write <code>expect(…).to.be.true</code>. For the most part I managed to do a search and replace for this.</p>
<p>This setup works really good! But there’s some minor details: The assertion errors thrown by Chai are slightly different than those expected by uvu., so sometimes I’d get messages or extra details that are not so relevant to the test itself. Another issue is that I’d receive diffs comparing <code>undefined</code> to <code>undefined</code> when an assertion failed. As a proper developer with too much free time, I went ahead and decided to experiment with <a href="https://xkcd.com/927/">writing my own assertion library</a> built on top of uvu’s assertions that I called <a href="https://github.com/pablo-abc/uvu-expect">uvu-expect</a>. Here’s more or less how I did it.</p>
<h2 id="the-expect-function">The “expect” function</h2>
<p>The main thing our assertion library needs is an <code>expect</code> function that should receive the value you’re planning to validate.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> function</span><span style="color:#50FA7B"> expect</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">value</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#6272A4">  // run your validations here</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>If we wanted to keep a similar API to Jest, this could return an object with functions.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> function</span><span style="color:#50FA7B"> expect</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">value</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">    toBe</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">expected</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">      if</span><span style="color:#F8F8F2"> (expected </span><span style="color:#FF79C6">!==</span><span style="color:#F8F8F2"> value) {</span></span>
<span class="line"><span style="color:#FF79C6">        throw</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Error</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">Expected values to be strictly equal</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">      }</span></span>
<span class="line"><span style="color:#F8F8F2">    },</span></span>
<span class="line"><span style="color:#F8F8F2">  };</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>But I actually really enjoyed Chai’s syntax. So I decided to use proxies to achieve something similar. We could start by allowing to chain arbitrary words after our <code>expect</code> call. I decided not to restrict the possible “chain” words to simplify development.</p>
<p><strong>Proxy</strong> is a JavaScript feature that allows you to “wrap” an object in order to intercept and modify its functionality. In our case we will use it to modify the behaviour when <em>accessing</em> our object’s properties.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> function</span><span style="color:#50FA7B"> expect</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">value</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> proxy </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Proxy</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#6272A4">    // The target we are adding the proxy on. For now it's empty.</span></span>
<span class="line"><span style="color:#F8F8F2">    {},</span></span>
<span class="line"><span style="color:#F8F8F2">    {</span></span>
<span class="line"><span style="color:#50FA7B">      get</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#6272A4">        // Any property access returns the proxy once again.</span></span>
<span class="line"><span style="color:#FF79C6">        return</span><span style="color:#F8F8F2"> proxy;</span></span>
<span class="line"><span style="color:#F8F8F2">      },</span></span>
<span class="line"><span style="color:#F8F8F2">    },</span></span>
<span class="line"><span style="color:#F8F8F2">  );</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> proxy;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">expect</span><span style="color:#F8F8F2">().this.does.nothing.but.also.does.not.crash;</span></span></code></pre>
<p>Next we will allow for <em>any</em> of these chain words to be functions.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> function</span><span style="color:#50FA7B"> expect</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">value</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> proxy </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Proxy</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">    {},</span></span>
<span class="line"><span style="color:#F8F8F2">    {</span></span>
<span class="line"><span style="color:#50FA7B">      get</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">_</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">outerProp</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#6272A4">        // Instead of returning the initial proxy, we return</span></span>
<span class="line"><span style="color:#6272A4">        // a new proxy that wraps a function.</span></span>
<span class="line"><span style="color:#FF79C6">        return</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Proxy</span><span style="color:#F8F8F2">(() </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> proxy, {</span></span>
<span class="line"><span style="color:#50FA7B">          get</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">_</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">innerProp</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#6272A4">            // If the function does not get called, and a property gets</span></span>
<span class="line"><span style="color:#6272A4">            // accessed directly, we access the same property</span></span>
<span class="line"><span style="color:#6272A4">            // from our original proxy.</span></span>
<span class="line"><span style="color:#FF79C6">            return</span><span style="color:#F8F8F2"> proxy[innerProp];</span></span>
<span class="line"><span style="color:#F8F8F2">          },</span></span>
<span class="line"><span style="color:#F8F8F2">        });</span></span>
<span class="line"><span style="color:#F8F8F2">      },</span></span>
<span class="line"><span style="color:#F8F8F2">    },</span></span>
<span class="line"><span style="color:#F8F8F2">  );</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> proxy;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">expect</span><span style="color:#F8F8F2">().this.does.</span><span style="color:#50FA7B">nothing</span><span style="color:#F8F8F2">().but.also.does.not.</span><span style="color:#50FA7B">crash</span><span style="color:#F8F8F2">();</span></span></code></pre>
<p>With this we already got the base for our syntax. We now need to be able to add some <em>meaning</em> to certain properties. For example, we might want to make <code>expect(…).to.be.null</code> to check whether a value is null or not.</p>
<h2 id="adding-meaning-to-our-properties">Adding meaning to our properties</h2>
<p>We could perfectly check the <code>name</code> of the property being accessed and use that to run validations. For example, if we wanted to add a validation for checking if a value is <code>null</code>:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#6272A4">// For brevity, we're not going to use the code that handles functions.</span></span>
<span class="line"><span style="color:#6272A4">// Only property access</span></span>
<span class="line"><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> function</span><span style="color:#50FA7B"> expect</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">value</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> proxy </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Proxy</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">    {},</span></span>
<span class="line"><span style="color:#F8F8F2">    {</span></span>
<span class="line"><span style="color:#50FA7B">      get</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">_</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">prop</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#6272A4">        // `prop` is the name of the propery being</span></span>
<span class="line"><span style="color:#6272A4">        // accessed.</span></span>
<span class="line"><span style="color:#FF79C6">        switch</span><span style="color:#F8F8F2"> (prop) {</span></span>
<span class="line"><span style="color:#FF79C6">          case</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">null</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#FF79C6">            if</span><span style="color:#F8F8F2"> (value </span><span style="color:#FF79C6">!==</span><span style="color:#BD93F9"> null</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">              throw</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Error</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">Expected value to be null</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">            }</span></span>
<span class="line"><span style="color:#FF79C6">            break</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#FF79C6">        return</span><span style="color:#F8F8F2"> proxy;</span></span>
<span class="line"><span style="color:#F8F8F2">      },</span></span>
<span class="line"><span style="color:#F8F8F2">    },</span></span>
<span class="line"><span style="color:#F8F8F2">  );</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> proxy;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">expect</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">null</span><span style="color:#F8F8F2">).to.be.null;</span></span>
<span class="line"><span style="color:#FF79C6">try</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  expect</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">not null</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">).to.be.null;</span></span>
<span class="line"><span style="color:#F8F8F2">} </span><span style="color:#FF79C6">catch</span><span style="color:#F8F8F2"> (err) {</span></span>
<span class="line"><span style="color:#F8F8F2">  console.</span><span style="color:#50FA7B">log</span><span style="color:#F8F8F2">(err.message); </span><span style="color:#6272A4">// => "Expected value to be null"</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>This can make our <code>expect</code> function hard to maintain, and adding more properties would not be so trivial. In order to make this more maintainable (and extensible) we’re going to handle this a bit differently.</p>
<h2 id="defining-properties">Defining properties</h2>
<p>Instead of proxying an empty object, we will proxy an object that contains the properties we want to have meaning.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> properties </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#6272A4">  // ...</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> function</span><span style="color:#50FA7B"> expect</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">value</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> proxy </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Proxy</span><span style="color:#F8F8F2">(properties, {</span></span>
<span class="line"><span style="color:#50FA7B">    get</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">target</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">outerProp</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#6272A4">      // `target` is our `properties` object</span></span>
<span class="line"><span style="color:#F8F8F2">      console.</span><span style="color:#50FA7B">log</span><span style="color:#F8F8F2">(target);</span></span>
<span class="line"><span style="color:#FF79C6">      return</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Proxy</span><span style="color:#F8F8F2">(() </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> proxy, {</span></span>
<span class="line"><span style="color:#50FA7B">        get</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">_</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">innerProp</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">          return</span><span style="color:#F8F8F2"> proxy[innerProp];</span></span>
<span class="line"><span style="color:#F8F8F2">        },</span></span>
<span class="line"><span style="color:#F8F8F2">      });</span></span>
<span class="line"><span style="color:#F8F8F2">    },</span></span>
<span class="line"><span style="color:#F8F8F2">  });</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> proxy;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>I decided to define each property as an object that contains two functions: <code>onAccess</code> to be executed on property access, and <code>onCall</code> to be executed when calling the property as a function. For example, our property for <code>null</code> could look like:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> isNull </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  onAccess</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">actual</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">    if</span><span style="color:#F8F8F2"> (actual </span><span style="color:#FF79C6">!==</span><span style="color:#BD93F9"> null</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">      throw</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Error</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">Expected value to be null</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span></code></pre>
<p>We can also define a property to check if two values are strictly equal:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> isEqual </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  onCall</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">actual</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">expected</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">    if</span><span style="color:#F8F8F2"> (actual </span><span style="color:#FF79C6">!==</span><span style="color:#F8F8F2"> expected) {</span></span>
<span class="line"><span style="color:#FF79C6">      throw</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Error</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">Expected values to be strictly equal</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span></code></pre>
<p>Then we can modify our <code>expect</code> function to call them when they’re accessed:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#6272A4">// We add the previously defined properties to</span></span>
<span class="line"><span style="color:#6272A4">// our `properties` object</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> properties </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">  null</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> isNull,</span></span>
<span class="line"><span style="color:#F8F8F2">  equal</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> isEqual,</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> function</span><span style="color:#50FA7B"> expect</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">value</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> proxy </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Proxy</span><span style="color:#F8F8F2">(properties, {</span></span>
<span class="line"><span style="color:#50FA7B">    get</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">target</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">outerProp</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">      const</span><span style="color:#F8F8F2"> property </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> target[outerProp];</span></span>
<span class="line"><span style="color:#6272A4">      // We execute the `onAccess` handler when one is found</span></span>
<span class="line"><span style="color:#F8F8F2">      property?.</span><span style="color:#50FA7B">onAccess</span><span style="color:#F8F8F2">?.(value);</span></span>
<span class="line"><span style="color:#FF79C6">      return</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Proxy</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">        (</span><span style="color:#FF79C6">...</span><span style="color:#FFB86C;font-style:italic">args</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#6272A4">          // We execute the `onCall` handler when one is found</span></span>
<span class="line"><span style="color:#F8F8F2">          property?.</span><span style="color:#50FA7B">onCall</span><span style="color:#F8F8F2">?.(value, </span><span style="color:#FF79C6">...</span><span style="color:#F8F8F2">args);</span></span>
<span class="line"><span style="color:#FF79C6">          return</span><span style="color:#F8F8F2"> proxy;</span></span>
<span class="line"><span style="color:#F8F8F2">        },</span></span>
<span class="line"><span style="color:#F8F8F2">        {</span></span>
<span class="line"><span style="color:#50FA7B">          get</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">_</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">innerProp</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">            return</span><span style="color:#F8F8F2"> proxy[innerProp];</span></span>
<span class="line"><span style="color:#F8F8F2">          },</span></span>
<span class="line"><span style="color:#F8F8F2">        },</span></span>
<span class="line"><span style="color:#F8F8F2">      );</span></span>
<span class="line"><span style="color:#F8F8F2">    },</span></span>
<span class="line"><span style="color:#F8F8F2">  });</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> proxy;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">expect</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">null</span><span style="color:#F8F8F2">).to.be.null;</span></span>
<span class="line"><span style="color:#50FA7B">expect</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">a</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">).to.</span><span style="color:#50FA7B">equal</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">a</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">);</span></span></code></pre>
<p>We suddenly have a really basic assertion library! And it can be easily extended by adding properties to our <code>properties</code> object!</p>
<p>There’s one thing we’re still not able to do with our current implementation: negate assertions. We need a way to modify the behaviour of future assertions.</p>
<h2 id="negating-assertions">Negating assertions</h2>
<p>In order to be able to achieve this, we need a way to communicate to our properties that the current assertions is being negated. For this we’re going to change a bit how we define our properties. Instead of expecting the <code>actual</code> value being validated as first argument, we’re going to receive a <code>context</code> object that will contain our <code>actual</code> value and a new <code>negated</code> property that will be a boolean indicating if the assertion is being negated. Our new properties for <code>equal</code> and <code>null</code> will then look like this:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> isNull </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  onAccess</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">context</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">    if</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">!</span><span style="color:#F8F8F2">context.negated </span><span style="color:#FF79C6">&#x26;&#x26;</span><span style="color:#F8F8F2"> context.actual </span><span style="color:#FF79C6">!==</span><span style="color:#BD93F9"> null</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">      throw</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Error</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">Expected value to be null</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#FF79C6">    if</span><span style="color:#F8F8F2"> (context.negated </span><span style="color:#FF79C6">&#x26;&#x26;</span><span style="color:#F8F8F2"> context.actual </span><span style="color:#FF79C6">===</span><span style="color:#BD93F9"> null</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">      throw</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Error</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">Expected value not to be null</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> isEqual </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  onCall</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">context</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">expected</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">    if</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">!</span><span style="color:#F8F8F2">context.negated </span><span style="color:#FF79C6">&#x26;&#x26;</span><span style="color:#F8F8F2"> context.actual </span><span style="color:#FF79C6">!==</span><span style="color:#F8F8F2"> expected) {</span></span>
<span class="line"><span style="color:#FF79C6">      throw</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Error</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">Expected values to be strictly equal</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#FF79C6">    if</span><span style="color:#F8F8F2"> (context.negated </span><span style="color:#FF79C6">&#x26;&#x26;</span><span style="color:#F8F8F2"> context.actual </span><span style="color:#FF79C6">===</span><span style="color:#F8F8F2"> expected) {</span></span>
<span class="line"><span style="color:#FF79C6">      throw</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Error</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">Expected values not to be strictly equal</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span></code></pre>
<p>And we can add a new property to negate our assertions:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> isNot </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  onAccess</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">context</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#6272A4">    // We set `negated` to true so future assertions</span></span>
<span class="line"><span style="color:#6272A4">    // will have knowledge of it.</span></span>
<span class="line"><span style="color:#F8F8F2">    context.negated </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span></code></pre>
<p>Then our expect function will call each handler with a <code>context</code> object instead of the actual value:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> properties </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">  null</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> isNull,</span></span>
<span class="line"><span style="color:#F8F8F2">  equal</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> isEqual,</span></span>
<span class="line"><span style="color:#F8F8F2">  not</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> isNot,</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> function</span><span style="color:#50FA7B"> expect</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">value</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#6272A4">  // Our context object</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> context </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">    actual</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> value,</span></span>
<span class="line"><span style="color:#F8F8F2">    negated</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> false</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  };</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> proxy </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Proxy</span><span style="color:#F8F8F2">(properties, {</span></span>
<span class="line"><span style="color:#50FA7B">    get</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">target</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">outerProp</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">      const</span><span style="color:#F8F8F2"> property </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> target[outerProp];</span></span>
<span class="line"><span style="color:#F8F8F2">      property?.</span><span style="color:#50FA7B">onAccess</span><span style="color:#F8F8F2">?.(context);</span></span>
<span class="line"><span style="color:#FF79C6">      return</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Proxy</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">        (</span><span style="color:#FF79C6">...</span><span style="color:#FFB86C;font-style:italic">args</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">          property?.</span><span style="color:#50FA7B">onCall</span><span style="color:#F8F8F2">?.(context, </span><span style="color:#FF79C6">...</span><span style="color:#F8F8F2">args);</span></span>
<span class="line"><span style="color:#FF79C6">          return</span><span style="color:#F8F8F2"> proxy;</span></span>
<span class="line"><span style="color:#F8F8F2">        },</span></span>
<span class="line"><span style="color:#F8F8F2">        {</span></span>
<span class="line"><span style="color:#50FA7B">          get</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">_</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">innerProp</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">            return</span><span style="color:#F8F8F2"> proxy[innerProp];</span></span>
<span class="line"><span style="color:#F8F8F2">          },</span></span>
<span class="line"><span style="color:#F8F8F2">        },</span></span>
<span class="line"><span style="color:#F8F8F2">      );</span></span>
<span class="line"><span style="color:#F8F8F2">    },</span></span>
<span class="line"><span style="color:#F8F8F2">  });</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> proxy;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">expect</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">a</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">).to.not.</span><span style="color:#50FA7B">equal</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">b</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">);</span></span></code></pre>
<p>This technique can be used to communicate more details about our assertions to future assertions.</p>
<h2 id="do-not-throw-normal-errors">Do not throw normal Errors</h2>
<p>To make examples simpler, we throw normal errors (<code>throw new Error(…)</code>). Since this is to be used with a test runner, it’d be better to throw something like Node’s built-in <a href="https://nodejs.org/api/assert.html#class-assertassertionerror"><code>AssertionError</code></a> or, in the case of uvu, its own <code>Assertion</code> error. These would give way more information when assertions fail. And it can be picked by Node or test runners to show prettier messages and diffs!</p>
<h2 id="conclusion">Conclusion</h2>
<p>This is a simplified explanation of how I made <a href="https://github.com/pablo-abc/uvu-expect">uvu-expect</a>. <code>uvu-expect</code> has way more features and validations such as:</p>
<ul>
<li><code>.resolves</code> and <code>.rejects</code> to assert on promises</li>
<li>Possibility to create plugins for it using an <code>extend</code> function. This is how I also created a plugin for it called <a href="https://github.com/pablo-abc/uvu-expect-dom">uvu-expect-dom</a> which offers similar validations to <code>@testing-library/jest-dom</code>.</li>
<li>Assertions on mock functions (compatible with <a href="https://sinonjs.org">sinonjs</a> and <a href="https://github.com/Aslemammad/tinyspy">tinyspy</a>).</li>
</ul>
<p>I aimed for it to have at least the features I used of Jest’s <code>expect</code>. You can read more about its features on its README! I documented everything about it there. Even how to create your own plugins for it.</p>
<p>It was a really fun side-project to build and explain. And it’s been working really well with our <a href="https://github.com/pablo-abc/felte/blob/main/packages/common/tests/utils.spec.ts">tests on Felte</a>.</p> </section> </article>  <footer data-astro-cid-gjtny2mx> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var l=(s,i,o)=>{let r=async()=>{await(await s())()},t=typeof i.value=="object"?i.value:void 0,c={rootMargin:t==null?void 0:t.rootMargin},n=new IntersectionObserver(e=>{for(let a of e)if(a.isIntersecting){n.disconnect(),r();break}},c);for(let e of o.children)n.observe(e)};(self.Astro||(self.Astro={})).visible=l;window.dispatchEvent(new Event("astro:visible"));})();;(()=>{var b=Object.defineProperty;var f=(c,o,i)=>o in c?b(c,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[o]=i;var l=(c,o,i)=>(f(c,typeof o!="symbol"?o+"":o,i),i);var p;{let c={0:t=>m(t),1:t=>i(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(i(t)),5:t=>new Set(i(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[e,r]=t;return e in c?c[e](r):void 0},i=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,r])=>[e,o(r)]));customElements.get("astro-island")||customElements.define("astro-island",(p=class extends HTMLElement{constructor(){super(...arguments);l(this,"Component");l(this,"hydrator");l(this,"hydrate",async()=>{var d;if(!this.hydrator||!this.isConnected)return;let e=(d=this.parentElement)==null?void 0:d.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let r=this.querySelectorAll("astro-slot"),a={},h=this.querySelectorAll("template[data-astro-template]");for(let n of h){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("data-astro-template")||"default"]=n.innerHTML,n.remove())}for(let n of r){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("name")||"default"]=n.innerHTML)}let u;try{u=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(n){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),n),n}await this.hydrator(this)(this.Component,u,a,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});l(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),r.disconnect(),this.childrenConnectedCallback()},r=new MutationObserver(()=>{var a;((a=this.lastChild)==null?void 0:a.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});r.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),r=this.getAttribute("client");if(Astro[r]===void 0){window.addEventListener(`astro:${r}`,()=>this.start(),{once:!0});return}Astro[r](async()=>{let a=this.getAttribute("renderer-url"),[h,{default:u}]=await Promise.all([import(this.getAttribute("component-url")),a?import(a):()=>()=>{}]),d=this.getAttribute("component-export")||"default";if(!d.includes("."))this.Component=h[d];else{this.Component=h;for(let n of d.split("."))this.Component=this.Component[n]}return this.hydrator=u,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},l(p,"observedAttributes",["props"]),p))}})();</script><astro-island uid="ZRnutX" component-url="/_astro/ShareButtons.tHG552y7.js" component-export="default" renderer-url="/_astro/client.bWR2MAd2.js" props="{&quot;host&quot;:[7,&quot;https://pablo.berganza.dev/&quot;],&quot;blog&quot;:[0,{&quot;Content&quot;:[0,null],&quot;compiledContent&quot;:[0,null],&quot;default&quot;:[0,null],&quot;file&quot;:[0,&quot;/home/runner/work/pablo.berganza.dev-astro/pablo.berganza.dev-astro/src/posts/en/creating-a-chai-like-assertion-library-using-proxies.md&quot;],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Creating a Chai like assertion library using proxies&quot;],&quot;description&quot;:[0,&quot;Showcasing how I made a fun side-project to be used with uvu&quot;],&quot;published&quot;:[0,true],&quot;created&quot;:[0,&quot;2022-02-19&quot;],&quot;imgext&quot;:[0,&quot;png&quot;],&quot;image&quot;:[0,{&quot;width&quot;:[0,1136],&quot;height&quot;:[0,852]}],&quot;crosspost&quot;:[0,{&quot;devto&quot;:[0,&quot;https://dev.to/pabloabc/creating-a-chai-like-assertion-library-using-proxies-1ol7&quot;],&quot;hashnode&quot;:[0,&quot;https://hn.berganza.dev/creating-a-chai-like-assertion-library-using-proxies&quot;]}],&quot;tags&quot;:[1,[[0,&quot;javascript&quot;],[0,&quot;testing&quot;],[0,&quot;uvu&quot;],[0,&quot;webdev&quot;]]]}],&quot;getHeadings&quot;:[0,null],&quot;rawContent&quot;:[0,null],&quot;url&quot;:[0],&quot;lang&quot;:[0,&quot;en&quot;],&quot;slug&quot;:[0,&quot;creating-a-chai-like-assertion-library-using-proxies&quot;],&quot;source&quot;:[0,&quot;---\ntitle: &#39;Creating a Chai like assertion library using proxies&#39;\ndescription: Showcasing how I made a fun side-project to be used with uvu\npublished: true\ncreated: &#39;2022-02-19&#39;\nimgext: png\nimage:\n  width: 1136\n  height: 852\ncrosspost:\n  devto: &#39;https://dev.to/pabloabc/creating-a-chai-like-assertion-library-using-proxies-1ol7&#39;\n  hashnode: &#39;https://hn.berganza.dev/creating-a-chai-like-assertion-library-using-proxies&#39;\ntags:\n  - javascript\n  - testing\n  - uvu\n  - webdev\n---\n\nFor the past few weeks I’ve taken the (arguably pointless) work of migrating [Felte](https://felte.dev) from using Jest to [uvu](https://github.com/lukeed/uvu). This is a really tedious work by itself, but one of details that would have made this work even more tedious is that Jest prefers assertions to the style of `expect(…).toBe*` while uvu gives you freedom to choose any assertion library, although there’s an official `uvu/assert` module that comes with assertions to the style of `assert.is(value, expected)`.\n\nWhile this is fine and I could have perfectly moved all my tests to use said assertion style, I like the descriptive way Jest tests look like. As a quick way to maintain certain similarity I reached for [ChaiJS](https://chaijs.com), an assertion library that is mainly used with [mocha](https://mochajs.org). Chai offers `expect` like assertions that can arguably be more descriptive than Jest’s. Instead of writing `expect(…).toBe(true)`, you’d write `expect(…).to.be.true`. For the most part I managed to do a search and replace for this.\n\nThis setup works really good! But there’s some minor details: The assertion errors thrown by Chai are slightly different than those expected by uvu., so sometimes I’d get messages or extra details that are not so relevant to the test itself. Another issue is that I’d receive diffs comparing `undefined` to `undefined` when an assertion failed. As a proper developer with too much free time, I went ahead and decided to experiment with [writing my own assertion library](https://xkcd.com/927/) built on top of uvu’s assertions that I called [uvu-expect](https://github.com/pablo-abc/uvu-expect). Here’s more or less how I did it.\n\n## The “expect” function\n\nThe main thing our assertion library needs is an `expect` function that should receive the value you’re planning to validate.\n\n```javascript\nexport function expect(value) {\n  // run your validations here\n}\n```\n\nIf we wanted to keep a similar API to Jest, this could return an object with functions.\n\n```javascript\nexport function expect(value) {\n  return {\n    toBe(expected) {\n      if (expected !== value) {\n        throw new Error(&#39;Expected values to be strictly equal&#39;);\n      }\n    },\n  };\n}\n```\n\nBut I actually really enjoyed Chai’s syntax. So I decided to use proxies to achieve something similar. We could start by allowing to chain arbitrary words after our `expect` call. I decided not to restrict the possible “chain” words to simplify development.\n\n**Proxy** is a JavaScript feature that allows you to \&quot;wrap\&quot; an object in order to intercept and modify its functionality. In our case we will use it to modify the behaviour when _accessing_ our object&#39;s properties.\n\n```javascript\nexport function expect(value) {\n  const proxy = new Proxy(\n    // The target we are adding the proxy on. For now it&#39;s empty.\n    {},\n    {\n      get() {\n        // Any property access returns the proxy once again.\n        return proxy;\n      },\n    },\n  );\n  return proxy;\n}\n\nexpect().this.does.nothing.but.also.does.not.crash;\n```\n\nNext we will allow for _any_ of these chain words to be functions.\n\n```javascript\nexport function expect(value) {\n  const proxy = new Proxy(\n    {},\n    {\n      get(_, outerProp) {\n        // Instead of returning the initial proxy, we return\n        // a new proxy that wraps a function.\n        return new Proxy(() =&gt; proxy, {\n          get(_, innerProp) {\n            // If the function does not get called, and a property gets\n            // accessed directly, we access the same property\n            // from our original proxy.\n            return proxy[innerProp];\n          },\n        });\n      },\n    },\n  );\n  return proxy;\n}\n\nexpect().this.does.nothing().but.also.does.not.crash();\n```\n\nWith this we already got the base for our syntax. We now need to be able to add some _meaning_ to certain properties. For example, we might want to make `expect(…).to.be.null` to check whether a value is null or not.\n\n## Adding meaning to our properties\n\nWe could perfectly check the `name` of the property being accessed and use that to run validations. For example, if we wanted to add a validation for checking if a value is `null`:\n\n```javascript\n// For brevity, we&#39;re not going to use the code that handles functions.\n// Only property access\nexport function expect(value) {\n  const proxy = new Proxy(\n    {},\n    {\n      get(_, prop) {\n        // `prop` is the name of the propery being\n        // accessed.\n        switch (prop) {\n          case &#39;null&#39;:\n            if (value !== null) {\n              throw new Error(&#39;Expected value to be null&#39;);\n            }\n            break;\n        }\n        return proxy;\n      },\n    },\n  );\n  return proxy;\n}\n\nexpect(null).to.be.null;\ntry {\n  expect(&#39;not null&#39;).to.be.null;\n} catch (err) {\n  console.log(err.message); // =&gt; \&quot;Expected value to be null\&quot;\n}\n```\n\nThis can make our `expect` function hard to maintain, and adding more properties would not be so trivial. In order to make this more maintainable (and extensible) we’re going to handle this a bit differently.\n\n## Defining properties\n\nInstead of proxying an empty object, we will proxy an object that contains the properties we want to have meaning.\n\n```javascript\nconst properties = {\n  // ...\n};\n\nexport function expect(value) {\n  const proxy = new Proxy(properties, {\n    get(target, outerProp) {\n      // `target` is our `properties` object\n      console.log(target);\n      return new Proxy(() =&gt; proxy, {\n        get(_, innerProp) {\n          return proxy[innerProp];\n        },\n      });\n    },\n  });\n  return proxy;\n}\n```\n\nI decided to define each property as an object that contains two functions: `onAccess` to be executed on property access, and `onCall` to be executed when calling the property as a function. For example, our property for `null` could look like:\n\n```javascript\nconst isNull = {\n  onAccess(actual) {\n    if (actual !== null) {\n      throw new Error(&#39;Expected value to be null&#39;);\n    }\n  },\n};\n```\n\nWe can also define a property to check if two values are strictly equal:\n\n```javascript\nconst isEqual = {\n  onCall(actual, expected) {\n    if (actual !== expected) {\n      throw new Error(&#39;Expected values to be strictly equal&#39;);\n    }\n  },\n};\n```\n\nThen we can modify our `expect` function to call them when they’re accessed:\n\n```javascript\n// We add the previously defined properties to\n// our `properties` object\nconst properties = {\n  null: isNull,\n  equal: isEqual,\n};\n\nexport function expect(value) {\n  const proxy = new Proxy(properties, {\n    get(target, outerProp) {\n      const property = target[outerProp];\n      // We execute the `onAccess` handler when one is found\n      property?.onAccess?.(value);\n      return new Proxy(\n        (...args) =&gt; {\n          // We execute the `onCall` handler when one is found\n          property?.onCall?.(value, ...args);\n          return proxy;\n        },\n        {\n          get(_, innerProp) {\n            return proxy[innerProp];\n          },\n        },\n      );\n    },\n  });\n  return proxy;\n}\n\nexpect(null).to.be.null;\nexpect(&#39;a&#39;).to.equal(&#39;a&#39;);\n```\n\nWe suddenly have a really basic assertion library! And it can be easily extended by adding properties to our `properties` object!\n\nThere’s one thing we’re still not able to do with our current implementation: negate assertions. We need a way to modify the behaviour of future assertions.\n\n## Negating assertions\n\nIn order to be able to achieve this, we need a way to communicate to our properties that the current assertions is being negated. For this we’re going to change a bit how we define our properties. Instead of expecting the `actual` value being validated as first argument, we’re going to receive a `context` object that will contain our `actual` value and a new `negated` property that will be a boolean indicating if the assertion is being negated. Our new properties for `equal` and `null` will then look like this:\n\n```javascript\nconst isNull = {\n  onAccess(context) {\n    if (!context.negated &amp;&amp; context.actual !== null) {\n      throw new Error(&#39;Expected value to be null&#39;);\n    }\n    if (context.negated &amp;&amp; context.actual === null) {\n      throw new Error(&#39;Expected value not to be null&#39;);\n    }\n  },\n};\n\nconst isEqual = {\n  onCall(context, expected) {\n    if (!context.negated &amp;&amp; context.actual !== expected) {\n      throw new Error(&#39;Expected values to be strictly equal&#39;);\n    }\n    if (context.negated &amp;&amp; context.actual === expected) {\n      throw new Error(&#39;Expected values not to be strictly equal&#39;);\n    }\n  },\n};\n```\n\nAnd we can add a new property to negate our assertions:\n\n```javascript\nconst isNot = {\n  onAccess(context) {\n    // We set `negated` to true so future assertions\n    // will have knowledge of it.\n    context.negated = true;\n  },\n};\n```\n\nThen our expect function will call each handler with a `context` object instead of the actual value:\n\n```javascript\nconst properties = {\n  null: isNull,\n  equal: isEqual,\n  not: isNot,\n};\n\nexport function expect(value) {\n  // Our context object\n  const context = {\n    actual: value,\n    negated: false,\n  };\n  const proxy = new Proxy(properties, {\n    get(target, outerProp) {\n      const property = target[outerProp];\n      property?.onAccess?.(context);\n      return new Proxy(\n        (...args) =&gt; {\n          property?.onCall?.(context, ...args);\n          return proxy;\n        },\n        {\n          get(_, innerProp) {\n            return proxy[innerProp];\n          },\n        },\n      );\n    },\n  });\n  return proxy;\n}\n\nexpect(&#39;a&#39;).to.not.equal(&#39;b&#39;);\n```\n\nThis technique can be used to communicate more details about our assertions to future assertions.\n\n## Do not throw normal Errors\n\nTo make examples simpler, we throw normal errors (`throw new Error(…)`). Since this is to be used with a test runner, it’d be better to throw something like Node’s built-in [`AssertionError`](https://nodejs.org/api/assert.html#class-assertassertionerror) or, in the case of uvu, its own `Assertion` error. These would give way more information when assertions fail. And it can be picked by Node or test runners to show prettier messages and diffs!\n\n## Conclusion\n\nThis is a simplified explanation of how I made [uvu-expect](https://github.com/pablo-abc/uvu-expect). `uvu-expect` has way more features and validations such as:\n\n- `.resolves` and `.rejects` to assert on promises\n- Possibility to create plugins for it using an `extend` function. This is how I also created a plugin for it called [uvu-expect-dom](https://github.com/pablo-abc/uvu-expect-dom) which offers similar validations to `@testing-library/jest-dom`.\n- Assertions on mock functions (compatible with [sinonjs](https://sinonjs.org) and [tinyspy](https://github.com/Aslemammad/tinyspy)).\n\nI aimed for it to have at least the features I used of Jest’s `expect`. You can read more about its features on its README! I documented everything about it there. Even how to create your own plugins for it.\n\nIt was a really fun side-project to build and explain. And it’s been working really well with our [tests on Felte](https://github.com/pablo-abc/felte/blob/main/packages/common/tests/utils.spec.ts).\n&quot;]}],&quot;lang&quot;:[0,&quot;en&quot;],&quot;data-astro-cid-gjtny2mx&quot;:[0,true]}" ssr="" client="visible" opts="{&quot;name&quot;:&quot;ShareButtons&quot;,&quot;value&quot;:true}" await-children=""><ul class="share-buttons svelte-utryih"><li class="svelte-utryih">Share this:</li> <li class="svelte-utryih"><a href="https://www.facebook.com/sharer/sharer.php?u=https://pablo.berganza.dev/creating-a-chai-like-assertion-library-using-proxies&amp;quote=Showcasing how I made a fun side-project to be used with uvu" target="_blank" title="Share on Facebook" rel="noopener noreferrer"><svg aria-hidden="true" title="" class="fa-svelte  svelte-1d15yci" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h137.25V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.27c-30.81 0-40.42 19.12-40.42 38.73V256h68.78l-11 71.69h-57.78V480H400a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48z"></path></svg> <span class="sr-only svelte-12xlsax">Share on Facebook</span> </a></li> <li class="svelte-utryih"><a href="https://twitter.com/intent/tweet?source=https://pablo.berganza.dev/creating-a-chai-like-assertion-library-using-proxies&amp;text=Showcasing how I made a fun side-project to be used with uvu:%20https://pablo.berganza.dev/creating-a-chai-like-assertion-library-using-proxies&amp;via=Pablo_ABC" target="_blank" title="Tweet" rel="noopener noreferrer"><svg aria-hidden="true" title="" class="fa-svelte  svelte-1d15yci" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM351.3 199.3v0c0 86.7-66 186.6-186.6 186.6c-37.2 0-71.7-10.8-100.7-29.4c5.3 .6 10.4 .8 15.8 .8c30.7 0 58.9-10.4 81.4-28c-28.8-.6-53-19.5-61.3-45.5c10.1 1.5 19.2 1.5 29.6-1.2c-30-6.1-52.5-32.5-52.5-64.4v-.8c8.7 4.9 18.9 7.9 29.6 8.3c-9-6-16.4-14.1-21.5-23.6s-7.8-20.2-7.7-31c0-12.2 3.2-23.4 8.9-33.1c32.3 39.8 80.8 65.8 135.2 68.6c-9.3-44.5 24-80.6 64-80.6c18.9 0 35.9 7.9 47.9 20.7c14.8-2.8 29-8.3 41.6-15.8c-4.9 15.2-15.2 28-28.8 36.1c13.2-1.4 26-5.1 37.8-10.2c-8.9 13.1-20.1 24.7-32.9 34c.2 2.8 .2 5.7 .2 8.5z"></path></svg> <span class="sr-only svelte-12xlsax">Tweet</span> </a></li> <li class="svelte-utryih"><a href="https://getpocket.com/save?url=https://pablo.berganza.dev/creating-a-chai-like-assertion-library-using-proxies&amp;title=Creating a Chai like assertion library using proxies" target="_blank" title="Add to Pocket" rel="noopener noreferrer"><svg aria-hidden="true" title="" class="fa-svelte  svelte-1d15yci" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M407.6 64h-367C18.5 64 0 82.5 0 104.6v135.2C0 364.5 99.7 464 224.2 464c124 0 223.8-99.5 223.8-224.2V104.6c0-22.4-17.7-40.6-40.4-40.6zm-162 268.5c-12.4 11.8-31.4 11.1-42.4 0C89.5 223.6 88.3 227.4 88.3 209.3c0-16.9 13.8-30.7 30.7-30.7 17 0 16.1 3.8 105.2 89.3 90.6-86.9 88.6-89.3 105.5-89.3 16.9 0 30.7 13.8 30.7 30.7 0 17.8-2.9 15.7-114.8 123.2z"></path></svg> <span class="sr-only svelte-12xlsax">Add to Pocket</span> </a></li> <li class="svelte-utryih"><a href="http://www.reddit.com/submit?url=https://pablo.berganza.dev/creating-a-chai-like-assertion-library-using-proxies&amp;title=Creating a Chai like assertion library using proxies" target="_blank" title="Submit to Reddit" rel="noopener noreferrer"><svg aria-hidden="true" title="" class="fa-svelte  svelte-1d15yci" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M283.2 345.5c2.7 2.7 2.7 6.8 0 9.2-24.5 24.5-93.8 24.6-118.4 0-2.7-2.4-2.7-6.5 0-9.2 2.4-2.4 6.5-2.4 8.9 0 18.7 19.2 81 19.6 100.5 0 2.4-2.3 6.6-2.3 9 0zm-91.3-53.8c0-14.9-11.9-26.8-26.5-26.8-14.9 0-26.8 11.9-26.8 26.8 0 14.6 11.9 26.5 26.8 26.5 14.6 0 26.5-11.9 26.5-26.5zm90.7-26.8c-14.6 0-26.5 11.9-26.5 26.8 0 14.6 11.9 26.5 26.5 26.5 14.9 0 26.8-11.9 26.8-26.5 0-14.9-11.9-26.8-26.8-26.8zM448 80v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V80c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48zm-99.7 140.6c-10.1 0-19 4.2-25.6 10.7-24.1-16.7-56.5-27.4-92.5-28.6l18.7-84.2 59.5 13.4c0 14.6 11.9 26.5 26.5 26.5 14.9 0 26.8-12.2 26.8-26.8 0-14.6-11.9-26.8-26.8-26.8-10.4 0-19.3 6.2-23.8 14.9l-65.7-14.6c-3.3-.9-6.5 1.5-7.4 4.8l-20.5 92.8c-35.7 1.5-67.8 12.2-91.9 28.9-6.5-6.8-15.8-11-25.9-11-37.5 0-49.8 50.4-15.5 67.5-1.2 5.4-1.8 11-1.8 16.7 0 56.5 63.7 102.3 141.9 102.3 78.5 0 142.2-45.8 142.2-102.3 0-5.7-.6-11.6-2.1-17 33.6-17.2 21.2-67.2-16.1-67.2z"></path></svg> <span class="sr-only svelte-12xlsax">Submit to Reddit</span> </a></li> <li class="svelte-utryih"><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://pablo.berganza.dev/creating-a-chai-like-assertion-library-using-proxies&amp;title=Creating a Chai like assertion library using proxies&amp;summary=Showcasing how I made a fun side-project to be used with uvu&amp;source=https://pablo.berganza.dev/creating-a-chai-like-assertion-library-using-proxies" target="_blank" title="Share on LinkedIn" rel="noopener noreferrer"><svg aria-hidden="true" title="" class="fa-svelte  svelte-1d15yci" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg> <span class="sr-only svelte-12xlsax">Share on LinkedIn</span> </a></li> <li class="svelte-utryih"><share-on-fedi placement="top" aria-label="Share on Mastodon" class="svelte-utryih"><svg aria-hidden="true" title="Share on Mastodon" class="fa-svelte  svelte-1d15yci" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"></path></svg></share-on-fedi></li> </ul><!--astro:end--></astro-island> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script><astro-island uid="1QRaJY" component-url="/_astro/Commento.ocQWcrc9.js" component-export="default" renderer-url="/_astro/client.bWR2MAd2.js" props="{&quot;lang&quot;:[0,&quot;en&quot;],&quot;src&quot;:[0,&quot;https://cdn.commento.io/js/commento.js&quot;],&quot;data-astro-cid-gjtny2mx&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Commento&quot;,&quot;value&quot;:true}"></astro-island> </footer> </main>  </body> </html>